<?php

$objects = array(
    'earth' => array(
        'name' => 'Erde',
        'fraction' => 'federation',
        'ma/de' => 'http://de.memory-alpha.org/wiki/Erde',
        'x' => 23.9,
        'y' => 61.8,
        'z' => 0, 0
    ),
    'vulcan' => array(
        'name' => 'Vulkan',
        'fraction' => 'federation',
        'x' => 19.5,
        'y' => 60.0,
        'z' => -0.6
    ),
    'tellar' => array(
        'name' => 'Tellar',
        'fraction' => 'federation',
        'x' => 25.0,
        'y' => 60.1,
        'z' => 2.6
    ),
    'andor' => array(
        'name' => 'Andor',
        'fraction' => 'federation',
        'x' => 25.8,
        'y' => 60.1,
        'z' => -2.4
    ),
    'alpha-centauri-7' => array(
        'name' => 'Alpha Centauri VII',
        'fraction' => 'federation',
        'x' => 24.6,
        'y' => 62.5,
        'z' => -1.4
    ),
    'alpha-3' => array(
        'name' => 'Alpha III',
        'fraction' => 'federation',
        'x' => 28.5,
        'y' => 52.8,
        'z' => 19.0
    ),
    'vega-4' => array(
        'name' => 'Vega IX',
        'fraction' => 'federation',
        'x' => 228.2,
        'y' => 61.3,
        'z' => 6.9
    ),
    'deneb' => array(
        'name' => 'DenebII, IV, V',
        'fraction' => 'federation',
        'x' => 142.7,
        'y' => -143.4,
        'z' => 382.5
    ),
    'marcos-12' => array(
        'name' => 'Marcos XII',
        'fraction' => 'federation',
        'x' => 26.9,
        'y' => 82.8,
        'z' => -2.2
    ),
    'izar' => array(
        'name' => 'Izar',
        'fraction' => 'federation',
        'x' => 36.7,
        'y' => 84.7,
        'z' => 17.6
    ),
    'rigel' => array(
        'name' => 'Rigel II, IV-VIII',
        'fraction' => 'federation',
        'x' => -209.9,
        'y' => 7.7,
        'z' => 136.0
    ),
    'cait' => array(
        'name' => 'Cait',
        'fraction' => 'federation',
        'x' => 41.9,
        'y' => -228.3,
        'z' => -12.6
    ),
    'antos-4' => array(
        'name' => 'Antos IV',
        'fraction' => 'federation',
        'x' => 18.1,
        'y' => -20.4,
        'z' => -6.1
    ),
    'tiburon' => array(
        'name' => 'Tiburon',
        'fraction' => 'federation',
        'x' => -121.9,
        'y' => -207.4,
        'z' => 236.4
    ),
    'merak-2' => array(
        'name' => 'Merak II',
        'fraction' => 'federation',
        'x' => 11.2,
        'y' => 72.7,
        'z' => 17.1
    ),
    'aldebaran' => array(
        'name' => 'Aldebaran',
        'fraction' => 'federation',
        'x' => 10.6,
        'y' => 56.5,
        'z' => -15.1
    ),
    'argelius-2' => array(
        'name' => 'Argelius II',
        'fraction' => 'federation',
        'x' => -154.7,
        'y' => -59.2,
        'z' => -121.2
    ),
    'daran-5' => array(
        'name' => 'Daran V',
        'fraction' => 'federation',
        'x' => -271.5,
        'y' => -139.2,
        'z' => -19.7
    ),
    'aurelia' => array(
        'name' => 'Aurelia',
        'fraction' => 'federation',
        'x' => 176.7,
        'y' => 44.5,
        'z' => -63.3
    ),
    'mantilles' => array(
        'name' => 'Mantilles',
        'fraction' => 'federation',
        'x' => 245.5,
        'y' => 188.3,
        'z' => -56.1
    ),
    'medusa' => array(
        'name' => 'Medusa',
        'fraction' => 'federation',
        'x' => 27.2,
        'y' => 137.6,
        'z' => -41.3
    ),
    'coridan' => array(
        'name' => 'Coridan',
        'fraction' => 'federation',
        'x' => 29.7,
        'y' => 64.3,
        'z' => 29.9
    ),
    'delta' => array(
        'name' => 'Delta',
        'fraction' => 'federation',
        'x' => 187.3,
        'y' => 89.9,
        'z' => -17.3
    ),
    'sauria' => array(
        'name' => 'Sauria',
        'fraction' => 'federation',
        'x' => -166.3,
        'y' => -43.3,
        'z' => 62.1
    ),
    'yonada' => array(
        'name' => 'Yonada',
        'fraction' => 'federation',
        'x' => -51.1,
        'y' => -93.6,
        'z' => -91.4
    ),
    'theta-kiokis-2' => array(
        'name' => 'Theta Kiokis II',
        'fraction' => 'federation',
        'x' => -76.9,
        'y' => -145.9,
        'z' => -12.7
    ),
    'betazed' => array(
        'name' => 'Betazed',
        'fraction' => 'federation',
        'ma/de' => 'http://de.memory-alpha.org/wiki/Betazed',
        'x' => -292.3,
        'y' => -93.3,
        'z' => -88.1
    ),
    'bynaus' => array(
        'name' => 'Bynaus',
        'fraction' => 'federation',
        'x' => -296.4,
        'y' => 98.9,
        'z' => 46.3
    ),
    'benzar' => array(
        'name' => 'Benzar',
        'fraction' => 'federation',
        'x' => 301.4,
        'y' => -57.4,
        'z' => 84.4
    ),
    'phylos-2' => array(
        'name' => 'Phylos II',
        'fraction' => 'federation',
        'x' => 306.5,
        'y' => -98.9,
        'z' => 187.4
    ),
    'antares-b-3' => array(
        'name' => 'Antares B III',
        'fraction' => NULL,
        'x' => 172.1,
        'y' => 118.9,
        'z' => -13.9
    ),
    'argo' => array(
        'name' => 'Argo',
        'fraction' => 'neutral',
        'x' => 133.4,
        'y' => -45.5,
        'z' => 32.9
    ),
    'berengaria-7' => array(
        'name' => 'Berengaria VII',
        'fraction' => NULL,
        'x' => -21.4,
        'y' => -51.8,
        'z' => -60.3
    ),
    'beta-3' => array(
        'name' => 'Beta III',
        'fraction' => 'neutral',
        'x' => 90.1,
        'y' => 71.9,
        'z' => -2.4
    ),
    'capella-4' => array(
        'name' => 'Capella IV',
        'fraction' => 'neutral',
        'x' => 11.1,
        'y' => 60.0,
        'z' => 4.6
    ),
    'ceti-alpha-5' => array(
        'name' => 'Ceti Alpha V',
        'fraction' => NULL,
        'x' => 12.4,
        'y' => 49.5,
        'z' => -19.7
    ),
    'delos' => array(
        'name' => 'Delos III, IV',
        'fraction' => 'neutral',
        'x' => 262.3,
        'y' => 43.2,
        'z' => -93.5
    ),
    'delta-dorado-7' => array(
        'name' => 'Delta Dorado VII',
        'fraction' => 'neutral',
        'x' => 54.5,
        'y' => 42.7,
        'z' => -242.9
    ),
    'dimorus-4' => array(
        'name' => 'Dimorus IV',
        'fraction' => 'neutral',
        'x' => -26.7,
        'y' => -18.8,
        'z' => -27.9
    ),
    '892-3' => array(
        'name' => '892-IV',
        'fraction' => 'neutral',
        'x' => -132.1,
        'y' => -101.1,
        'z' => -56.7
    ),
    'eminiar' => array(
        'name' => 'Eminiar III, VII',
        'fraction' => 'neutral',
        'x' => -37.0,
        'y' => 222.3,
        'z' => 25.1
    ),
    'excalbia-1' => array(
        'name' => 'Excalbia I',
        'fraction' => 'neutral',
        'x' => -54.8,
        'y' => -157.7,
        'z' => -193.4
    ),
    'gamma-trianguli-6' => array(
        'name' => 'Gamma Trianguli VI',
        'fraction' => 'neutral',
        'x' => -170.5,
        'y' => -126.6,
        'z' => 91.6
    ),
    'iotia' => array(
        'name' => 'Iotia',
        'fraction' => 'neutral',
        'x' => -5.7,
        'y' => -144.2,
        'z' => -109.1
    ),
    'janus-6' => array(
        'name' => 'Janus VI',
        'fraction' => 'neutral',
        'x' => -123.8,
        'y' => -30.1,
        'z' => -15.8
    ),    
    'kaferia' => array(
        'name' => '    Kaferia',
        'fraction' => 'neutral',
        'x' => 22.8,
        'y' => 58.7,
        'z' => -1.5
    ),    
   'klinzhai' => array(
        'name' => 'Klinzhai',
        'fraction' => 'klingon',
        'x' => -321.5,
        'y' => 48.6,
        'z' => -87.9
    ),   
   'lactra-7' => array(
        'name' => 'Lactra VII',
        'fraction' => 'neutral',
        'x' => 264.7,
        'y' => 65.4,
        'z' => 98.1 
    ),
    'organia-4' => array(
        'name' => 'Organia IV',
        'fraction' => 'neutral',
        'x' => -112.6,
        'y' => 186.3,
        'z' => -12.1
    ),  
    'regulus' => array(
        'name' => 'Regulus',
        'fraction' => NULL,
        'x' => 10.7,
        'y' => 83.9,
        'z' => 0.7
    ),   
     'talos-4' => array(
        'name' => 'Talos IV',
        'fraction' => 'neutral',
        'x' => -119.4,
        'y' => -43.7,
        'z' => -24.0
    ),
    'taurus-2' => array(
        'name' => 'Taurus II',
        'fraction' => 'neutral',
        'x' => -154.7,
        'y' => -59.2,
        'z' => -121.2
    ),
    'velara-3' => array(
        'name' => 'Velara III',
        'fraction' => 'neutral',
        'x' => 199.2,
        'y' => 18.4,
        'z' => 45.7
    ), 
    'zeta-bootis-3' => array(
        'name' => 'Zeta Bootis III',
        'fraction' => NULL,
        'x' => 57.8,
        'y' => 114.1,
        'z' => 33.1
    ), 
    
    'tau-lacertae-9' => array(
        'name' => 'Tau Lacertae IX',
        'fraction' => 'gorn',
        'x' => -421.3,
        'y' => -166.7,
        'z' => 67.7
    ), 
    'romulus' => array(
        'name' => 'Romulus',
        'fraction' => 'romulan',
        'x' => -176.3,
        'y' => -158.5,
        'z' => -1.8
    ),    
);


function cmp($a, $b) {
    if ($a['z'] == $b['z']) {
        return 0;
    }
    return ($a['z'] < $b['z']) ? -1 : 1;
}

usort($objects, "cmp");

            
foreach ($objects as $object) {
  if (!isset($lowest_x)) {
    $lowest_x = $object['x'];
  }
  if (!isset($lowest_y)) {
    $lowest_y = $object['y'];
  }
  if (!isset($highest_x)) {
    $highest_x = $object['x'];
  }

  if (!isset($highest_y)) {
    $highest_y = $object['y'];
  }

  if ($object['x'] < $lowest_x) {
    $lowest_x = $object['x'];
  }
  if ($object['y'] < $lowest_y) {
    $lowest_y = $object['y'];
  }
  if ($object['x'] > $highest_x) {
    $highest_x = $object['x'];
  }
  if ($object['y'] > $highest_y) {
    $highest_y = $object['y'];
  }
}
#print $lowest_x . ' ';
#print $lowest_y . ' ';
#print $highest_x . ' ';
#print $highest_y . ' ';

$range_x = $highest_x - $lowest_x;
#print $range_x . ' ';

$range_y = $highest_y - $lowest_y;
#print $range_y . ' ';

$framewidth = 100;

$offset_x = $lowest_x - $framewidth;
$offset_y = $lowest_y - $framewidth;

header("Content-Type: image/svg+xml");
echo '<?xml version="1.0" encoding="iso-8859-1"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.0//EN" "http://www.w3.org/TR/2001/REC-SVG-20010904/DTD/svg10.dtd">';

echo '<svg xmlns="http://www.w3.org/2000/svg" height="' . ($range_y + (2 * $framewidth)) . '" width="' . ($range_x + (2 * $framewidth)) . '" style="background-color:black" xmlns:xlink="http://www.w3.org/1999/xlink" >';

echo '<defs><radialGradient id="federation" cx="0.5" cy="0.5" r="0.4">
                <stop stop-color="#00009E" stop-opacity="1" offset="0" />
                <stop stop-color="#00009E" stop-opacity="0" offset="1" />
        </radialGradient>
        <radialGradient id="neutral" cx="0.5" cy="0.5" r="0.4">
                <stop stop-color="#464646" stop-opacity=".7" offset="0" />
                <stop stop-color="#464646" stop-opacity="0" offset="1" />
        </radialGradient>
        <radialGradient id="romulan" cx="0.5" cy="0.5" r="0.4">
                <stop stop-color="green" stop-opacity=".7" offset="0" />
                <stop stop-color="green" stop-opacity="0" offset="1" />
        </radialGradient>
        <radialGradient id="klingon" cx="0.5" cy="0.5" r="0.4">
                <stop stop-color="red" stop-opacity=".7" offset="0" />
                <stop stop-color="red" stop-opacity="0" offset="1" />
        </radialGradient>
        <radialGradient id="gorn" cx="0.5" cy="0.5" r="0.4">
                <stop stop-color="brown" stop-opacity=".7" offset="0" />
                <stop stop-color="brown" stop-opacity="0" offset="1" />
        </radialGradient>
</defs>';

echo '<rect x="' . $framewidth . '" y="' . $framewidth . '" width="' . $range_x . '" height="' . $range_y . '"  stroke="red" />';

foreach ($objects as $object) {
  if ($object['fraction'] != NULL) {
    echo '<circle cx="' . ($object['x'] - $offset_x) . '" cy="' . ($object['y'] - $offset_y) . '" r="100"  fill="url(#' . $object['fraction'] . ')" />';
  }
}

for ($i = 1; $i <= 1000; $i++) {
#  echo '<circle cx="' . (rand($offset_x,$range_x) - $offset_x) . '" cy="' . (rand($offset_y,$range_y) - $offset_y) . '" r="1.5" fill="white" opacity=".3" />';
}


foreach ($objects as $object) {
  echo '<circle cx="' . ($object['x'] - $offset_x) . '" cy="' . ($object['y'] - $offset_y) . '" r="2" fill="white" />';
  
  $text = $object['name'];
  $element = '<text x="' . ($object['x'] - $offset_x + 5) . '" y="' . ($object['y'] - $offset_y + 3) . '" style="fill:white; font-family: sans-serif;font-size:10px">' . $text . '</text>';
  
  if($object['ma/de']) {
    echo '<a xlink:href="http://www.w3schools.com" target="_blank">' . $element . '</a>';
  } else {
    echo $element;
  }
  
  
}

echo '</svg>';
